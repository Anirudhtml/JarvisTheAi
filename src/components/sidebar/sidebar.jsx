import React, { useState } from "react";
import ChatDropBox from "../chatDropBox/chatDropBox";
import './sideBar.css';

function SideBar({ user, setChatName, setRecentChats, setSavedChats, savedChat, isSidebarVisible }) {

  const [searchInput, setUserSearchInput] = useState("")

  const handleNewChat = async() => {
    try {
      const response = await fetch("http://3.96.64.168:4000/newChat", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({user})
      })

      setRecentChats([])
      setChatName("Name Chat")

    } catch(err) {
      console.log("error occured while resetinfg the chat", err)
    }
  }

  return (
    <>
      <div className="SideBar">
        <div className={`SideBarContainer ${isSidebarVisible ? "" : "hidden"}`}>
          <div className="logo">
            <div className="iconAndName">
              <svg
                fill="#ffffff"
                height="50px"
                width="50px"
                version="1.1"
                id="Capa_1"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                viewBox="-203.72 -203.72 870.44 870.44"
                xml:space="preserve"
                stroke="#b026ff"
                transform="matrix(1, 0, 0, 1, 0, 0)rotate(0)"
              >
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g
                  id="SVGRepo_tracerCarrier"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                ></g>
                <g id="SVGRepo_iconCarrier">
                  {" "}
                  <g>
                    {" "}
                    <path d="M421.88,107.557c-1.366-2.211-3.78-3.557-6.38-3.557h-72.52c0.127-1.906-0.474-3.802-1.708-5.29 c-1.425-1.717-3.54-2.71-5.771-2.71h-26.221c1.14-5.397,1.721-10.916,1.721-16.5C311,35.664,275.337,0,231.5,0S152,35.664,152,79.5 c0,5.584,0.58,11.103,1.72,16.5H127.5c-2.231,0-4.347,0.993-5.771,2.71c-1.234,1.487-1.836,3.384-1.708,5.29H47.5 c-2.6,0-5.014,1.346-6.38,3.557c-1.366,2.211-1.491,4.972-0.328,7.297L54.58,142.43c2.642,5.286,7.954,8.57,13.864,8.57h0.351 l-12.417,68.295c-0.007,0.037-0.008,0.073-0.014,0.109C56.13,220.735,56,222.102,56,223.5c0,10.828,7.363,19.964,17.344,22.676 l21.521,93.256l-10.719,5.359c-2.54,1.27-4.146,3.867-4.146,6.708v24c0,2.841,1.605,5.438,4.146,6.708l16,8 c1.077,0.539,2.222,0.793,3.349,0.793c2.751,0,5.4-1.52,6.714-4.147c1.853-3.705,0.351-8.21-3.354-10.062L95,370.865v-14.729 l8.5-4.25l8.5,4.25V367.5c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5v-16c0-2.841-1.605-5.438-4.146-6.708l-12.841-6.421 L88.512,245.2c7.216-3.008,12.617-9.513,14.084-17.387c0.007-0.036,0.018-0.071,0.025-0.108L116.568,151h12.208l29.038,154.871 c4.696,25.05,21.571,45.227,43.793,54.904C186.223,370.652,176,387.899,176,407.5c0,30.603,24.897,55.5,55.5,55.5 s55.5-24.897,55.5-55.5c0-19.601-10.223-36.848-25.607-46.725c22.222-9.677,39.097-29.855,43.793-54.904L334.224,151h12.208 l13.947,76.705c0.007,0.037,0.018,0.072,0.025,0.108c1.467,7.874,6.869,14.379,14.084,17.387l-21.501,93.171l-12.841,6.421 c-2.54,1.27-4.146,3.867-4.146,6.708v16c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5v-11.365l8.5-4.25l8.5,4.25v14.729 l-11.854,5.927c-3.704,1.852-5.206,6.357-3.354,10.062c1.313,2.628,3.963,4.148,6.714,4.147c1.127,0,2.271-0.255,3.349-0.793l16-8 c2.54-1.27,4.146-3.867,4.146-6.708v-24c0-2.841-1.605-5.438-4.146-6.708l-10.719-5.359l21.521-93.256 C399.637,243.464,407,234.328,407,223.5c0-1.398-0.13-2.765-0.365-4.096c-0.006-0.036-0.008-0.073-0.014-0.109L394.204,151h0.351 c5.91,0,11.223-3.284,13.863-8.568l13.789-27.578C423.371,112.529,423.246,109.768,421.88,107.557z M167,79.5 c0-35.565,28.935-64.5,64.5-64.5S296,43.935,296,79.5c0,5.615-0.719,11.143-2.132,16.5H169.133C167.719,90.643,167,85.114,167,79.5 z M299.25,111c0.05,0.001,0.101,0.006,0.151,0.006c0.028,0,0.054-0.006,0.082-0.006h26.979l-1.688,9h-31.496 c-11.727,0-21.501,8.417-23.24,20.014L251.64,262.678C250.134,272.715,241.675,280,231.476,280 c-10.15,0-18.609-7.285-20.115-17.322l-18.399-122.664C191.222,128.417,181.447,120,169.721,120h-31.496l-1.688-9H299.25z M79.5,215c4.687,0,8.5,3.813,8.5,8.5s-3.813,8.5-8.5,8.5s-8.5-3.813-8.5-8.5S74.813,215,79.5,215z M91.781,203.474 C88.205,201.273,83.999,200,79.5,200c-1.52,0-3.005,0.15-4.445,0.427L84.042,151h17.28L91.781,203.474z M110.981,136 c-0.437-0.04-0.869-0.036-1.294,0H68.444c-0.19,0-0.361-0.105-0.447-0.276L59.636,119h63.14l3.188,17H110.981z M272,407.5 c0,19.768-14.24,36.264-33,39.792V423.5c0-4.142-3.357-7.5-7.5-7.5s-7.5,3.358-7.5,7.5v23.792c-18.76-3.529-33-20.024-33-39.792 s14.24-36.264,33-39.792V391.5c0,4.142,3.357,7.5,7.5,7.5s7.5-3.358,7.5-7.5v-23.792C257.76,371.236,272,387.732,272,407.5z M290.443,303.106C285.131,331.437,260.354,352,231.529,352h-0.059c-28.825,0-53.602-20.563-58.914-48.894L141.037,135h28.684 c4.173,0,7.787,3.112,8.406,7.239l18.399,122.664C199.142,282.342,213.84,295,231.524,295c17.636,0,32.334-12.658,34.949-30.098 l18.399-122.664c0.619-4.126,4.233-7.239,8.406-7.239h28.684L290.443,303.106z M383.5,232c-4.687,0-8.5-3.813-8.5-8.5 s3.813-8.5,8.5-8.5s8.5,3.813,8.5,8.5S388.187,232,383.5,232z M387.945,200.427c-1.44-0.277-2.925-0.427-4.445-0.427 c-4.499,0-8.705,1.273-12.281,3.474L361.678,151h17.28L387.945,200.427z M395.002,135.725c-0.085,0.169-0.256,0.275-0.446,0.275 H353.31c-0.425-0.036-0.856-0.04-1.293,0h-14.981l3.188-17h63.14L395.002,135.725z"></path>{" "}
                    <path d="M279,67.5c0-10.493-8.337-19.053-18.731-19.461C260.016,48.013,259.76,48,259.5,48h-56c-0.26,0-0.516,0.013-0.769,0.039 C192.337,48.447,184,57.007,184,67.5s8.337,19.053,18.731,19.461C202.984,86.987,203.24,87,203.5,87h56 c0.26,0,0.516-0.013,0.769-0.039C270.663,86.553,279,77.993,279,67.5z M199,67.5c0-2.481,2.019-4.5,4.5-4.5s4.5,2.019,4.5,4.5 s-2.019,4.5-4.5,4.5S199,69.981,199,67.5z M222.455,63h18.09c-0.344,1.447-0.545,2.949-0.545,4.5s0.201,3.053,0.545,4.5h-18.09 c0.344-1.447,0.545-2.949,0.545-4.5S222.799,64.447,222.455,63z M255,67.5c0-2.481,2.019-4.5,4.5-4.5s4.5,2.019,4.5,4.5 s-2.019,4.5-4.5,4.5S255,69.981,255,67.5z"></path>{" "}
                    <path d="M231.5,263c4.143,0,7.5-3.358,7.5-7.5v-48c0-4.142-3.357-7.5-7.5-7.5s-7.5,3.358-7.5,7.5v48 C224,259.642,227.357,263,231.5,263z"></path>{" "}
                  </g>{" "}
                </g>
              </svg>
              <p>My Chats</p>
            </div>
            <svg
              width="40px"
              height="40px"
              viewBox="-5 -5 35.00 35.00"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g
                id="SVGRepo_tracerCarrier"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></g>
              <g id="SVGRepo_iconCarrier">
                {" "}
                <path                                                                                                                                                                                                          
                  d="M5.5 7.75C5.08579 7.75 4.75 8.08579 4.75 8.5C4.75 8.91421 5.08579 9.25 5.5 9.25V7.75ZM19.5 9.25C19.9142 9.25 20.25 8.91421 20.25 8.5C20.25 8.08579 19.9142 7.75 19.5 7.75V9.25ZM5.5 11.75C5.08579 11.75 4.75 12.0858 4.75 12.5C4.75 12.9142 5.08579 13.25 5.5 13.25V11.75ZM17.5 13.25C17.9142 13.25 18.25 12.9142 18.25 12.5C18.25 12.0858 17.9142 11.75 17.5 11.75V13.25ZM5.5 15.75C5.08579 15.75 4.75 16.0858 4.75 16.5C4.75 16.9142 5.08579 17.25 5.5 17.25V15.75ZM12.5 17.25C12.9142 17.25 13.25 16.9142 13.25 16.5C13.25 16.0858 12.9142 15.75 12.5 15.75V17.25ZM5.5 9.25H19.5V7.75H5.5V9.25ZM5.5 13.25H17.5V11.75H5.5V13.25ZM5.5 17.25H12.5V15.75H5.5V17.25Z"
                  fill="#ffffff"
                ></path>{" "}
              </g>
            </svg>
          </div>
          <div className="savedChats">
            <div className="SearchBar">
              <svg
                width="20px"
                height="20px"
                viewBox="-7.68 -7.68 47.36 47.36"
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:xlink="http://www.w3.org/1999/xlink"
                xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"
                fill="#000000"
                transform="matrix(1, 0, 0, 1, 0, 0)rotate(0)"
              >
                <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                <g
                  id="SVGRepo_tracerCarrier"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke="#CCCCCC"
                  stroke-width="0.32"
                ></g>
                <g id="SVGRepo_iconCarrier">
                  {" "}
                  <title>search</title> <desc>Created with Sketch Beta.</desc>{" "}
                  <defs> </defs>{" "}
                  <g
                    id="Page-1"
                    stroke-width="0.00032"
                    fill="none"
                    fill-rule="evenodd"
                    sketch:type="MSPage"
                  >
                    {" "}
                    <g
                      id="Icon-Set"
                      sketch:type="MSLayerGroup"
                      transform="translate(-256.000000, -1139.000000)"
                      fill="#b3b3b3"
                    >
                      {" "}
                      <path
                        d="M269.46,1163.45 C263.17,1163.45 258.071,1158.44 258.071,1152.25 C258.071,1146.06 263.17,1141.04 269.46,1141.04 C275.75,1141.04 280.85,1146.06 280.85,1152.25 C280.85,1158.44 275.75,1163.45 269.46,1163.45 L269.46,1163.45 Z M287.688,1169.25 L279.429,1161.12 C281.591,1158.77 282.92,1155.67 282.92,1152.25 C282.92,1144.93 276.894,1139 269.46,1139 C262.026,1139 256,1144.93 256,1152.25 C256,1159.56 262.026,1165.49 269.46,1165.49 C272.672,1165.49 275.618,1164.38 277.932,1162.53 L286.224,1170.69 C286.629,1171.09 287.284,1171.09 287.688,1170.69 C288.093,1170.3 288.093,1169.65 287.688,1169.25 L287.688,1169.25 Z"
                        id="search"
                        sketch:type="MSShapeGroup"
                      >
                        {" "}
                      </path>{" "}
                    </g>{" "}
                  </g>{" "}
                </g>
              </svg>
              <input value={searchInput} onChange={(e) => setUserSearchInput(e.target.value)} className="chatSearchBar" placeholder="Search" />
            </div>

            <div>
              <p>Chats</p>
              <ChatDropBox setSavedChats={setSavedChats} setRecentChats={setRecentChats} user={user} savedChat={savedChat} />
            </div>

            <div onClick={handleNewChat} className="newChat">
              <span>New Chat</span>
            </div>
          </div>
        </div>
      </div>
    </>
  );
}

export default SideBar;
